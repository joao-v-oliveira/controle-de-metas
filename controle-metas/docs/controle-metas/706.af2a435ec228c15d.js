"use strict";(self.webpackChunkcontrole_metas=self.webpackChunkcontrole_metas||[]).push([[706],{3706:(K,I,s)=>{s.r(I),s.d(I,{CadastroModule:()=>X});var f=s(9808),h=s(0),n=s(3075),u=s(508),t=s(5e3),p=s(5439);const m=p||s.t(p,2),N=new t.OlP("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function j(){return{useUtc:!1}}});function w(a,l){const e=Array(a);for(let o=0;o<a;o++)e[o]=l(o);return e}let k=(()=>{class a extends u._A{constructor(e,o){super(),this._options=o,this.setLocale(e||m.locale())}setLocale(e){super.setLocale(e);let o=m.localeData(e);this._localeData={firstDayOfWeek:o.firstDayOfWeek(),longMonths:o.months(),shortMonths:o.monthsShort(),dates:w(31,i=>this.createDate(2017,0,i+1).format("D")),longDaysOfWeek:o.weekdays(),shortDaysOfWeek:o.weekdaysShort(),narrowDaysOfWeek:o.weekdaysMin()}}getYear(e){return this.clone(e).year()}getMonth(e){return this.clone(e).month()}getDate(e){return this.clone(e).date()}getDayOfWeek(e){return this.clone(e).day()}getMonthNames(e){return"long"==e?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(e){return"long"==e?this._localeData.longDaysOfWeek:"short"==e?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(e){return this.clone(e).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(e){return this.clone(e).daysInMonth()}clone(e){return e.clone().locale(this.locale)}createDate(e,o,i){const r=this._createMoment({year:e,month:o,date:i}).locale(this.locale);return r.isValid(),r}today(){return this._createMoment().locale(this.locale)}parse(e,o){return e&&"string"==typeof e?this._createMoment(e,o,this.locale):e?this._createMoment(e).locale(this.locale):null}format(e,o){return e=this.clone(e),this.isValid(e),e.format(o)}addCalendarYears(e,o){return this.clone(e).add({years:o})}addCalendarMonths(e,o){return this.clone(e).add({months:o})}addCalendarDays(e,o){return this.clone(e).add({days:o})}toIso8601(e){return this.clone(e).format()}deserialize(e){let o;if(e instanceof Date)o=this._createMoment(e).locale(this.locale);else if(this.isDateInstance(e))return this.clone(e);if("string"==typeof e){if(!e)return null;o=this._createMoment(e,m.ISO_8601).locale(this.locale)}return o&&this.isValid(o)?this._createMoment(o).locale(this.locale):super.deserialize(e)}isDateInstance(e){return m.isMoment(e)}isValid(e){return this.clone(e).isValid()}invalid(){return m.invalid()}_createMoment(e,o,i){const{strict:r,useUtc:d}=this._options||{};return d?m.utc(e,o,i,r):m(e,o,i,r)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(u.Ad,8),t.LFG(N,8))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac}),a})();class E{constructor(){this.idmeta=0,this.titulo="",this.datainicio="",this.previsaotermino="",this.descricao="",this.tipometa=!1,this.valorinicial=0,this.valorobjetivo=0,this.objetivos=[],this.progresso=0}}class S{constructor(){this.descricao="",this.completo=!1}}var Y=s(2290),F=s(520);let L=(()=>{class a{constructor(e){this.http=e,this.URL="http://localhost:3000/",this.header={"Content-Type":"application/json"}}postMeta(e){return this.http.post(`${this.URL}metas`,JSON.stringify(e),{headers:this.header})}putMeta(e,o){return this.http.put(`${this.URL}metas/${e}`,JSON.stringify(o),{headers:this.header})}postMetaPromisse(e){return new Promise((i,r)=>{e.valorinicial<0?r("O valor inicial precisa ser um valor positivo ou zero(0)!"):(localStorage.setItem("metaLocalStorage",JSON.stringify(e)),i(e))})}getMeta(e){return this.http.get(`${this.URL}metas/${e}`,{headers:this.header})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(F.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var g=s(3489),$=s(7531),v=s(2492),O=s(9814),J=s(7423),U=s(5245),V=s(7446),P=s(4834);function q(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",29)(2,"mat-form-field",9)(3,"mat-label"),t._uU(4,"Valor inicial"),t.qZA(),t.TgZ(5,"input",30),t.NdJ("change",function(){return t.CHM(e),t.oxw().formatValor(1)}),t.qZA()()(),t.TgZ(6,"div",29)(7,"mat-form-field",9)(8,"mat-label"),t._uU(9,"Valor total da meta"),t.qZA(),t.TgZ(10,"input",31),t.NdJ("change",function(){return t.CHM(e),t.oxw().formatValor(2)}),t.qZA()()(),t._UZ(11,"div",32),t.qZA()}}const Z=function(){return{standalone:!0}};function R(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"div",41)(1,"div",42)(2,"mat-checkbox",21),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.completo=i}),t.qZA()(),t.TgZ(3,"div",39),t._uU(4),t.qZA()()}if(2&a){const e=l.$implicit;t.xp6(2),t.Q6J("ngModel",e.completo)("ngModelOptions",t.DdM(3,Z)),t.xp6(2),t.hij(" ",e.descricao," ")}}function z(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",19)(2,"div",33)(3,"mat-form-field",9)(4,"mat-label"),t._uU(5,"Objetivo"),t.qZA(),t._UZ(6,"input",34),t.qZA()(),t.TgZ(7,"div",29)(8,"button",35),t.NdJ("click",function(){return t.CHM(e),t.oxw().addObjetivo()}),t.TgZ(9,"mat-icon"),t._uU(10,"add"),t.qZA()()()(),t.TgZ(11,"div",36)(12,"div",37)(13,"div",38),t._uU(14," Status "),t.qZA(),t.TgZ(15,"div",39),t._uU(16," Objetivo "),t.qZA()(),t.YNc(17,R,5,4,"div",40),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(6),t.Q6J("formControl",e.objdescricao),t.xp6(11),t.Q6J("ngForOf",e.objetivos)}}const Q=function(){return["/inicio"]},W={parse:{dateInput:["l","LL"]},display:{dateInput:"L",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},H=[{path:"",component:(()=>{class a{constructor(e,o,i,r){this.router=e,this.toastr=o,this.cadastroService=i,this.activatedRoute=r,this.meta=new E,this.objdescricao=new n.NI(""),this.objetivos=[],this.tipoMeta=!1,this.formMeta=new n.cw({nome:new n.NI("",[n.kI.required,n.kI.minLength(8)]),inicio:new n.NI(null,n.kI.required),previsao:new n.NI(null,n.kI.required),descricao:new n.NI("",n.kI.required),tipometa:new n.NI(!1),valorinicial:new n.NI(null),valorobjetivo:new n.NI(null),objetivos:new n.NI(null)})}ngOnInit(){this.activatedRoute.params.subscribe(e=>{this.metaId=e.metaId}),"null"!=this.metaId&&"undefined"!=this.metaId&&this.cadastroService.getMeta(this.metaId).subscribe(e=>{var o,i;this.meta=e,this.tipoMeta=this.meta.tipometa,this.formMeta=new n.cw({nome:new n.NI(this.meta.titulo,[n.kI.required,n.kI.minLength(8)]),inicio:new n.NI(null,n.kI.required),previsao:new n.NI(null,n.kI.required),descricao:new n.NI(this.meta.descricao,n.kI.required),tipometa:new n.NI(this.meta.tipometa),valorinicial:new n.NI(this.meta.valorinicial),valorobjetivo:new n.NI(this.meta.valorobjetivo)}),this.objetivos=this.meta.objetivos,this.meta.progresso=this.getValueProgess(this.meta.valorobjetivo,this.meta.valorinicial,this.objetivos),this.setDate(p(this.meta.datainicio),1),this.setDate(p(this.meta.previsaotermino),2),this.tipoMeta||(-1===this.meta.valorinicial.toString().search(/[.]/g)&&(null===(o=this.formMeta.get("valorinicial"))||void 0===o||o.setValue(this.meta.valorinicial.toString()+"00")),this.formatValor(1),-1===this.meta.valorobjetivo.toString().search(/[.]/g)&&(null===(i=this.formMeta.get("valorobjetivo"))||void 0===i||i.setValue(this.meta.valorobjetivo.toString()+"00")),this.formatValor(2))})}ngOnDestroy(){this.formMeta.reset()}validaCampo(e){var o,i;!(null===(o=this.formMeta.get(e))||void 0===o?void 0:o.valid)&&""!=(null===(i=this.formMeta.get(e))||void 0===i?void 0:i.value)&&this.toastr.warning("Corrija o campo para ficar dentro dos padr\xf5es","Aten\xe7\xe3o")}salvarMeta(){var e,o,i,r,d,c,M,_,D,C,b,A;let T=this.getValueProgess(null!=(null===(e=this.formMeta.get("valorobjetivo"))||void 0===e?void 0:e.value)?this.getFloat(null===(o=this.formMeta.get("valorobjetivo"))||void 0===o?void 0:o.value):null,null!=(null===(i=this.formMeta.get("valorinicial"))||void 0===i?void 0:i.value)?this.getFloat(null===(r=this.formMeta.get("valorinicial"))||void 0===r?void 0:r.value):null,this.objetivos),y={titulo:null===(d=this.formMeta.get("nome"))||void 0===d?void 0:d.value,datainicio:this.getFormatDateSave(null===(c=this.formMeta.get("inicio"))||void 0===c?void 0:c.value),previsaotermino:this.getFormatDateSave(null===(M=this.formMeta.get("previsao"))||void 0===M?void 0:M.value),descricao:null===(_=this.formMeta.get("descricao"))||void 0===_?void 0:_.value,tipometa:this.tipoMeta,valorinicial:null!=(null===(D=this.formMeta.get("valorinicial"))||void 0===D?void 0:D.value)?this.getFloat(null===(C=this.formMeta.get("valorinicial"))||void 0===C?void 0:C.value):null,valorobjetivo:null!=(null===(b=this.formMeta.get("valorobjetivo"))||void 0===b?void 0:b.value)?this.getFloat(null===(A=this.formMeta.get("valorobjetivo"))||void 0===A?void 0:A.value):null,objetivos:this.objetivos.length>0?this.objetivos:[],progresso:null!=this.meta?T:null,status:null!=this.meta?T<100?"Em progresso":"Finalizado":"Em progresso"};console.log(T),this.cadastroService.postMetaPromisse(y).then(()=>{"null"!=this.metaId&&"undefined"!=this.metaId?(this.cadastroService.putMeta(this.metaId,y).subscribe(),this.toastr.success("Meta atualizada com sucesso","Sucesso")):(this.cadastroService.postMeta(y).subscribe(),this.toastr.success("Meta inclu\xedda com sucesso","Sucesso"))}).catch(()=>{this.toastr.error("Erro ao tentar incluir uma meta, tente novamente!","Erro")}).finally(()=>{setTimeout(()=>{this.router.navigate(["/inicio"])},10)})}getFormatDateSave(e){return p(e).format("YYYY-MM-DD")}addObjetivo(){if(console.log(this.objdescricao.value),""!=this.objdescricao.value&&null!=this.objdescricao.value){let e=new S;e.completo=!1,e.descricao=this.objdescricao.value,this.objetivos.push(e),this.objdescricao.setValue("")}else this.toastr.warning("Descreva seu objetivo antes de incluir","Aten\xe7\xe3o")}formatValor(e){var o,i,r,d;if(1==e){let c=null===(o=this.formMeta.get("valorinicial"))||void 0===o?void 0:o.value;c=this.limpaValor(c),null===(i=this.formMeta.get("valorinicial"))||void 0===i||i.setValue(c)}else{let c=null===(r=this.formMeta.get("valorobjetivo"))||void 0===r?void 0:r.value;c=this.limpaValor(c),null===(d=this.formMeta.get("valorobjetivo"))||void 0===d||d.setValue(c)}}limpaValor(e){let o=-1!==e.toString().search(/[,]/gi)?e.toString().replace(/[^0-9]/gi,""):e.toString();return 3==(e=-1!==o.toString().search(/[.]/g)?o.toString().replace(/[^0-9]/gi,""):o.toString()).length?e=e.replace(/(\d{1})(\d{2})/g,"$1.$2"):4==e.length?e=e.replace(/(\d{2})(\d{2})/g,"$1.$2"):5==e.length?e=e.replace(/(\d{3})(\d{2})/g,"$1.$2"):6==e.length?e=e.replace(/(\d{1})(\d{3})(\d{2})/g,"$1,$2.$3"):7==e.length?e=e.replace(/(\d{2})(\d{3})(\d{2})/g,"$1,$2.$3"):8==e.length?e=e.replace(/(\d{3})(\d{3})(\d{2})/g,"$1,$2.$3"):9==e.length?e=e.replace(/(\d{1})(\d{3})(\d{3})(\d{2})/g,"$1,$2,$3.$4"):10==e.length&&(e=e.replace(/(\d{2})(\d{3})(\d{3})(\d{2})/g,"$1,$2,$3.$4")),e}setDate(e,o){var i,r;1==o?null===(i=this.formMeta.get("inicio"))||void 0===i||i.setValue(e):null===(r=this.formMeta.get("previsao"))||void 0===r||r.setValue(e)}getFloat(e){return-1!=e.search(/,/)?(e=e.toString().replace(/,/gi,""),parseFloat(e)):parseFloat(e).toFixed(2)}getValueProgess(e,o,i=[]){if(i.length>0){let r=0;return i.forEach(d=>{d.completo&&r++}),Math.round(r/i.length*100)}return 100-Math.round((e-o)/e*100)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(h.F0),t.Y36(Y._W),t.Y36(L),t.Y36(h.gz))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-cadastro"]],features:[t._Bn([{provide:u.Ad,useValue:"pt-BR"},{provide:u._A,useClass:k,deps:[u.Ad]},{provide:u.sG,useValue:W}])],decls:62,vars:15,consts:[[1,"contener"],[1,"quadro-dados"],[3,"formGroup"],[1,"row",2,"display","flex"],[1,"col-md-10","titulo-inicio"],[1,"col-md-2"],[2,"float","right"],[1,"row","espaco-row"],[1,"col-xl-6"],["appearance","legacy"],["matInput","","pattern","([aA-zZ\\s]+)","formControlName","nome","placeholder","Ex: Comprar Casa",3,"change"],[1,"col-xl-3"],["matInput","","formControlName","inicio",3,"matDatepicker","click"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","previsao",3,"matDatepicker","click"],["picker2",""],[1,"col-xl-12"],["rows","8","formControlName","descricao","matInput","",3,"change"],[1,"row"],[1,"col-md-12","titulo-inicio"],[3,"ngModel","ngModelOptions","ngModelChange"],[3,"value"],["class","row espaco-row",4,"ngIf"],[1,"col-xl-12","botoes"],[1,"col-xl-8"],[1,"col-xl-2"],["mat-raised-button","",1,"btn-cancelar",3,"routerLink"],["mat-raised-button","",1,"btn-salvar",3,"disabled","click"],[1,"col-md-3"],["type","text","formControlName","valorinicial","matInput","","placeholder","0,00",3,"change"],["type","text","formControlName","valorobjetivo","matInput","","placeholder","100.000,00",3,"change"],[1,"col-md-6"],[1,"col-md-9"],["matInput","","placeholder","Ex: Realizar um or\xe7amento na loja",3,"formControl"],["mat-raised-button","",1,"btn-add",3,"click"],[1,"col-md-12","div-cabecalho"],[1,"row","espaco-row","cabecalho"],[1,"col-md-1"],[1,"col-md-11"],["class","row espaco-row linha-tabela",4,"ngFor","ngForOf"],[1,"row","espaco-row","linha-tabela"],[1,"col-md-1",2,"padding","0 1.5rem"]],template:function(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"form",2)(3,"div",3)(4,"div",4)(5,"h1"),t._uU(6,"Cadastro de Meta"),t.qZA()(),t.TgZ(7,"div",5)(8,"h1",6),t._uU(9,"Status"),t.qZA()()(),t.TgZ(10,"div",7)(11,"div",8)(12,"mat-form-field",9)(13,"mat-label"),t._uU(14,"Nome"),t.qZA(),t.TgZ(15,"input",10),t.NdJ("change",function(){return o.validaCampo("nome")}),t.qZA()()(),t.TgZ(16,"div",11)(17,"mat-form-field",9)(18,"mat-label"),t._uU(19,"Data de \xcdnicio"),t.qZA(),t.TgZ(20,"input",12),t.NdJ("click",function(){return t.CHM(i),t.MAs(23).open()}),t.qZA(),t._UZ(21,"mat-datepicker-toggle",13)(22,"mat-datepicker",null,14),t.qZA()(),t.TgZ(24,"div",11)(25,"mat-form-field",9)(26,"mat-label"),t._uU(27,"Previs\xe3o de T\xe9rmino"),t.qZA(),t.TgZ(28,"input",15),t.NdJ("click",function(){return t.CHM(i),t.MAs(31).open()}),t.qZA(),t._UZ(29,"mat-datepicker-toggle",13)(30,"mat-datepicker",null,16),t.qZA()()(),t.TgZ(32,"div",7)(33,"div",17)(34,"mat-form-field",9)(35,"mat-label"),t._uU(36,"Descri\xe7\xe3o"),t.qZA(),t.TgZ(37,"textarea",18),t.NdJ("change",function(){return o.validaCampo("descricao")}),t.qZA()()()(),t.TgZ(38,"div",19)(39,"div",20)(40,"h1"),t._uU(41,"Tipo de Meta"),t.qZA()()(),t.TgZ(42,"div",7)(43,"mat-radio-group",21),t.NdJ("ngModelChange",function(d){return o.tipoMeta=d}),t.TgZ(44,"mat-radio-button",22),t._uU(45,"Meta de Dinheiro"),t.qZA(),t.TgZ(46,"mat-radio-button",22),t._uU(47,"Meta de Objetivos"),t.qZA()()(),t.YNc(48,q,12,0,"div",23),t.YNc(49,z,18,2,"div",23),t.TgZ(50,"div",7)(51,"div",17),t._UZ(52,"mat-divider"),t.qZA()(),t.TgZ(53,"div",7)(54,"div",24),t._UZ(55,"div",25),t.TgZ(56,"div",26)(57,"button",27),t._uU(58,"CANCELAR"),t.qZA()(),t.TgZ(59,"div",26)(60,"button",28),t.NdJ("click",function(){return o.salvarMeta()}),t._uU(61,"SALVAR"),t.qZA()()()()()()()}if(2&e){const i=t.MAs(23),r=t.MAs(31);t.xp6(2),t.Q6J("formGroup",o.formMeta),t.xp6(18),t.Q6J("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(7),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(14),t.Q6J("ngModel",o.tipoMeta)("ngModelOptions",t.DdM(13,Z)),t.xp6(1),t.Q6J("value",!1),t.xp6(2),t.Q6J("value",!0),t.xp6(2),t.Q6J("ngIf",0==o.tipoMeta),t.xp6(1),t.Q6J("ngIf",o.tipoMeta),t.xp6(8),t.Q6J("routerLink",t.DdM(14,Q)),t.xp6(3),t.Q6J("disabled",!o.formMeta.valid)}},directives:[n._Y,n.JL,n.sg,g.KE,g.hX,$.Nt,n.Fj,n.c5,n.JJ,n.u,v.hl,v.nW,g.R9,v.Mq,O.VQ,n.On,O.U0,f.O5,n.oH,J.lW,U.Hw,f.sg,V.oG,P.d,h.rH],styles:[".contener[_ngcontent-%COMP%]{min-height:calc(100% - 4rem);padding:1.5rem;background-color:#eaeaea}.quadro-dados[_ngcontent-%COMP%]{min-height:45rem;padding:2rem;background-color:#fff}.titulo-inicio[_ngcontent-%COMP%]{align-items:center;font-family:Red Hat Display;font-style:normal;font-weight:700;font-size:30px;line-height:140%;padding:1rem}.espaco-row[_ngcontent-%COMP%]{padding:1rem}.botoes[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:end}.btn-salvar[_ngcontent-%COMP%]{width:200px;height:40px;color:#fff;background-color:#0f0;float:right}.btn-cancelar[_ngcontent-%COMP%]{width:200px;height:40px;color:#fff;background-color:#ff3030;float:right}.btn-add[_ngcontent-%COMP%]{width:100%;display:flex;height:52px;flex-direction:row;justify-content:center;align-items:center;border:1px solid #7B809A}.cabecalho[_ngcontent-%COMP%]{height:48px;background:#9DA3AC;font-style:normal;font-weight:500;font-size:12px;line-height:16px;text-transform:uppercase;color:#fff}.div-cabecalho[_ngcontent-%COMP%]{padding:1rem 1rem 0}.linha-tabela[_ngcontent-%COMP%]{height:55px;border:1px solid rgba(0,0,0,.1);font-style:normal;font-weight:400;font-size:14px;color:#444}[_nghost-%COMP%]       mat-form-field{font-size:18px!important;width:100%}[_nghost-%COMP%]       textarea.mat-input-element{max-height:193px!important}  mat-radio-button{padding:0!important;padding-right:1rem!important}"]}),a})()}];let B=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.Bz.forChild(H)],h.Bz]}),a})();var G=s(5296);let X=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[f.ez,B,G.q,n.u5,n.UX]]}),a})()}}]);